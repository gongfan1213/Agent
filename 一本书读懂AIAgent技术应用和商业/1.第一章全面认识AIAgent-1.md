# | 第一部分 |
# 技术认知
AI Agent结合了LLM、机器学习等技术，正快速推动AI的进化。基于LLM的AI Agent代表着人机交互的新范式，展现了人机协同的潜力。对于新手来说，要进入AI Agent领域，首先要了解AI Agent的运作机制、核心技术、算法突破及当前挑战。
在这一部分，我们将首先从宏观视角对AI Agent进行全面梳理，使读者了解AI Agent的概念、特征、发展历程及分类，构建起对AI Agent的基本认知框架。然后深入探究AI Agent的核心技术，从多个维度解析技术架构与算法原理，让读者了解AI Agent的技术本质。最后将审视AI Agent的最新研究进展，分析其面临的技术挑战，展望其未来的发展方向。
通过这一部分的学习，读者将对AI Agent有一个立体、清晰且深入的认知，为进一步探索AI Agent的应用实践、商业价值和创投逻辑打下坚实基础。

# |第1章| CHAPTER
全面认识AI Agent
这一章我们将进入AI Agent世界，从基本概念到最新的研究进展，全面介绍AI Agent的相关概念、发展历程和现状，向读者展示AI Agent的魅力和潜力。通过本章的学习，读者可以全面系统地了解AI Agent的内涵、发展历程、分类等，为后面的学习奠定基础。
# 1.1 AI Agent的概念、特征与定义
基于LLM的AI Agent是人工智能领域的新兴概念，它代表着智能系统的新阶段和人机交互的革命性变革。作为能自主感知、思考、决策和行动的智能实体，AI Agent正成为连接现实与数字世界的桥梁。掌握AI Agent的概念和特征，可以为进一步探索其技术原理、应用场景和商业价值奠定基础。本章将探索AI Agent的基本概念和特征，回顾其发展历程，并介绍不同的分类方式，从功能、结构、应用等维度展示其多样性，帮助读者构建初步的认知框架。
## 1.1.1 AI Agent的概念
### 1. 早期的Agent概念
从字面来看，AI Agent包括AI和Agent两个词。AI是指人工智能（Artificial
Intelligence），1956年由马文·明斯基（Marvin Minsky）、约翰·麦卡锡（John McCarthy）等科学家在达特茅斯会议上正式提出。“Agent”一词则出现得更早，它源于拉丁语中的Agere，最早的意思是“to do”，到15世纪90年代逐渐演变为“代理人，代表”。1950年，艾伦·图灵（Alan Turing）将Agent引入人工智能领域，并得到了很多人的响应。其中，马文·明斯基在1951年提出了一些关于思维如何萌发与形成的基本理论，并建造了一台名为Snare的学习机。Snare是世界上第一个神经网络模拟器，其设计目的是学习如何穿过迷宫，它包括40个Agent和1个对成功进行奖励的系统。
马文·明斯基也是最早将Agent概念写入著作中的学者。1985年，马文·明斯基的The Society of Mind（《心智社会》）一书出版。他在书中写道：“智能不是任何单独的机制的产物，而是众多各异的有能力的Agent之间存在的一种受到管理的互动。”甚至，他认为人类实际上就是某种机器，人类的大脑是由许多半自主但不智能的Agent构成的。

真正给出Agent定义的，还是斯图亚特·罗素（Stuart Russell）和彼得·诺维格（Peter Norvig）所著、1995年出版的Artificial Intelligence: A Modern Approach（《人工智能：现代研究方法》）一书。该书认为，Agent是任何可以通过传感器感知其环境并通过执行器作用于该环境的东西，能够在这个环境中自主行动，以实现其设计目标，并赋予Agent自主性、反应性、社会能力及主动性等四个基本属性。在这个定义下，Agent可能很复杂，也可能很简单，复杂的如人和动物，简单的如恒温器或类似的控制系统。

前面提到Agent的发展历史，是为了告诉大家一直以来Agent都是与AI技术共同发展的，或者说AI技术就是为了实现Agent的，甚至Agent理念启发了AI技术的说法也是有一定道理的。两者的发展一脉相承，在AI技术取得重大突破后，Agent就会有更佳的表现，这一点从早期IBM研发的深蓝以及前些年的AlphaGo身上都能体现出来。而对于早期的Agent，大家更愿意将其称作“智能代理”（Intelligent Agent）。
Agent的发展历程很有意思也很值得了解，1.2节会详细阐述。
### 2. 当代的Agent概念

一直以来，Agent的功能与体验受限于AI技术，简单地讲，就是“大脑”不够聪明。而当下AI Agent之所以比较火，是因为AI技术在LLM上的突破与爆发，从生成到计算再到逻辑推理能力都有了质的飞跃，使Agent能够为大家带来更多功能及更好的体验。

为了体现当代Agent是构建于LLM之上的，国外将其称为自主Agent（AI Agent中的一种），以体现其融合了LLM的特点，国内则将其称作AI Agent、人工智能体或者人工智能体，还有些文章将其直译为“AI代理”。在计算机专业技术领域，Agent曾被译为“代理”“代理者”“智能主体”等，现在一般将Agent译为“智能体”。其定义是在一定的环境中体现出自治性、反应性、主动性、预动性、思辨性（慎思性）、认知性等智能特征中的一种或多种的软件或硬件实体。

如今来到LLM时代，Agent将基于LLM构建。研发出ChatGPT并持续引领LLM发展的OpenAI将AI Agent定义为：以LLM为大脑驱动，具有自主理解感知、规划、记忆和使用工具的能力，能自动化执行完成复杂任务的系统。

LLM具备理解、生成、逻辑、记忆等能力，使基于LLM的AI Agent成为一种能够感知环境、进行决策和执行动作的智能实体。是否具备通过独立思考、调用工具逐步完成给定目标的能力，成了基于LLM的AI Agent与基于传统AI技术的Agent的最大不同，也是很多人在给当代AI Agent下定义时强调的点。比如，告诉AI Agent帮忙下单一一份外卖，它就可以直接调用App选择外卖，再调用支付程序下单支付，而无须人类指定每一步的操作。

基于LLM的AI Agent能够通过LLM进行分析与思考，能够规划各种任务，并能够通过API调用各种工具去执行多种任务，具备了更为强大的能力。LLM庞大的训练数据集中含有大量人类行为数据，为模拟人类的交互打下了坚实基础。而随着模型规模的不断增大，LLM涌现出了上下文学习能力、推理能力、思维链等类似人类思考方式的多种能力。基于LLM的一般AI Agent框架如图1-1所示。

将LLM作为AI Agent的核心大脑，可以实现以往难以实现的将复杂问题拆解成可实现的子任务、人类的自然语言交互等能力。具备这些能力后，AI Agent就能像人类一样思考并进行交互。所以，LLM的发展推动了AI Agent的进一步发展。LLM浪潮席卷全球之后，很多人认为LLM已经非常接近AGI了 。但经过了一段时间的发展，当人们对LLM的能力边界有了清晰认知后，发现LLM存在幻觉、上下文容量限制等问题，因此LLM并不是通向AGI的捷径。

AGI为Artificial General Intelligence的首字母缩写，意为通用人工智能。它是一种可以执行复杂任务的人工智能，能够完全模仿人类智能的行为。AGI被认为是人工智能的更高层次，可以实现自我学习、自我改进、自我调整，进而解决任何问题，而不需要人工干预。


![image](https://github.com/user-attachments/assets/ed36db83-6f65-42d8-99e7-8cc2eb51a2bf)


图1-1 基于LLM的一般AI Agent框架

这种情况下，AI Agent就成为新的研究方向，标志性事件是AutoGPT的火爆出圈。让LLM借助一个或多个Agent的能力，构建具备自主思考决策和执行能力的Agent，成了走向AGI的更佳路线。LLM的出现，让人们相信AGI能够更快到来，AI Agent则是通往AGI的桥梁。

站在LLM技术前沿的OpenAI，于2023年10月将“AGI focus”（聚焦AGI）列在其企业核心价值观首位，更加强调AGI的发展。同年11月，它举办首届OpenAI开发者大会并发布GPT、GPT Store、Assistants API等产品，围绕AI Agent进行布局。

比尔·盖茨认为，在未来五年内，人工智能将彻底改变人们使用计算机的方式。Agent会成为未来计算的新平台，将改变软件业务和社会的方方面面。它将对医疗保健、教育、生产力、娱乐、购物等领域产生巨大影响，为大众带来更便宜、更方便的服务。

### 1.1.2 AI Agent的特征

在Agent跟随LLM变得火热之前，学者们已经给Agent下过定义。但随着技术的不断发展，它的定义也在发生变化。尤其是分布式人工智能和分布式计算的出现，使得人们对Agent一直没有统一的认知，想要给它下一个确切的定义不是一件容易的事。不过，我们可以从学者们给出的定义里寻找Agent的共性，从而发现它的普遍特征。组织和学者们从不同的角度给出了Agent的不同定义，主要有以下几种：

1）Agent技术标准化组织FIPA（The Foundation for Intelligent Physical Agents）给Agent下的定义是：“Agent是驻留于环境中的实体，它可以解释从环境中获得的反映环境中所发生事件的数据，并执行对环境产生影响的行动。”在这个定义中，Agent被看作一种在环境中“生存”的实体，既可以是硬件（如机器人），也可以是软件。

2）著名Agent理论研究学者Michael Wooldridge博士等在讨论Agent时，提出了“弱定义”和“强定义”两种定义方法：弱定义Agent是指具有自主性、社会性、反应性和能动性等基本特性的Agent；强定义Agent是指除了弱定义中的基本特性，还具有移动性、通信能力、理性或其他特性的Agent。

3）孟菲斯大学教授Stan Franklin和Arthur C. Graesser则这样描述Agent：“一个处于环境之中并且作为这个环境一部分的系统，它随时可以感测环境并且执行相应的动作，同时逐渐建立自己的活动规划以应对未来可能感测到的环境变化。”

4）著名人工智能学者、斯坦福大学的Hayes-Roth认为：“Agent能够持续执行三项功能：感知环境中的动态条件；执行动作影响环境条件；进行推理以解释感知信息、求解问题、产生推断和决定动作。”

由这些定义，我们可以归纳出Agent的基本特征：


● 自主性 / 自治性（Autonomy）：Agent能根据外界环境的变化自动调整自己的行为和状态，而不是被动地接受外界的刺激，它具有自我管理、自我调节的能力。其运行无须人类或其他Agent直接干预，或对其行为及内部状态进行某种控制。

● 反应性（Reactive）：具备对外界的刺激做出反应的能力，能感知环境（可以是物理世界、一个经图形用户接口连接的用户、一系列其他Agent、Internet或所有这些的组合），并对环境的变化及时做出反应。

● 主动性（Proactive）：对于外界环境的改变，Agent能主动采取行动的能力，不但能对环境做出反应，更能够积极主动地做出使其目标得以实现的行为。

● 社会性（Social）：Agent具有与其他Agent（或人类）进行合作的能力，可根据自身的意图与其他Agent（或人类）进行交互，以达到解决问题的目的。交互主要有三种类型：协作（Cooperation）、协调（Coordination）和协商（Negotiation）。

● 进化性：Agent能积累或学习经验和知识，并修改自己的行为以适应新环境。

有了这些特征，AI Agent就能在各种应用场景中表现出足够的主动能力，并发挥重要作用。比如自动驾驶汽车就是一个典型的AI Agent，它能够自动驾驶，适应路况变化，做出安全的驾驶决策，并且能够从驾驶经验中学习，提高驾驶性能。L5级别的自动驾驶将会成为真正的自主Agent。
### 1.1.3 AI Agent的定义

前文说了那么多，还没有正式给AI Agent下一个定义。眼下AI技术已经进入LLM时代，因此我们要探寻的主要是基于LLM的AI Agent对人类社会与经济的影响。经过产学研用各界的探索，目前由复旦大学NLP团队提出的AI Agent定义已经得到社会各界的认可，即AI Agent是一种能够感知环境、进行决策和执行动作的智能实体。

为了加强大家对AI Agent的认知，在介绍AI Agent时我们一般会将其与传统AI进行对比：传统AI被动响应输入，而AI Agent拥有主动思考和解决问题的能力，给定一个目标，能够独立分解任务，制订计划，并调用各种工具来执行。

当代AI Agent的典型特征是基于LLM，具备感知、记忆、规划和使用工具的能力，能够自动化实现用户复杂的目标。AI Agent能够在没有明确指令的情况下做出反应，根据环境变化灵活调整行为。这些Agent可以是基于软件的实体，也可以是物理实体，通常使用人工智能技术构建。它们通过传感器感知环境，并通过执行器对其环境起作用，可以具有知识、信仰、意图等心理属性。

AI Agent的核心功能包括感知、推理和决策。感知是指AI Agent通过传感器等方式获取环境信息的能力，例如通过摄像头获取图像或通过麦克风获取声音。推理和决策则是基于对环境的感知来执行任务的过程，这种感知和行动的能力使AI Agent能够在特定任务或领域中自主地进行学习和改进。

AI Agent的应用非常广泛，可以应用于多个领域，如自动驾驶车辆、智能机器人、语音助手等。它们的工作方式类似于人类代理：能够接收输入数据（例如传感器信息、文本、图像等），通过分析和处理这些数据，理解环境和任务要求，并做出相应的决策和行动。总的来说，AI Agent是一种高度智能化的实体，它通过感知、推理和决策等能力，在各种环境中自主地完成任务和交互，展现出一定的自主性和自适应性。

自主Agent涉及AI Agent的分类，我们将会在1.3节详细介绍。前面讲过，不同时代新技术的出现总会让Agent的定义产生些许变化，LLM的出现也让当代AI Agent具备了更具体的内涵。基于LLM的AI Agent的特征，将在第2章介绍。

## 1.2 AI Agent的发展历程

AI Agent是伴随着人工智能技术不断迭代、应用场景不断拓展而发展的。从20世纪50年代“人工智能之父”图灵提出“机器能思考吗？”的问题，到21世纪10年代AI Agent在各行各业落地开花，这一技术范式经历了从理论探索到工程实践的漫长演进。这一过程中，AI Agent的概念内涵不断丰富，技术架构不断升级，呈现出从规则到学习再到认知的发展脉络。

而要从概念上去探索的话，AI Agent最早可以追溯到公元前500年左右。本节将从发展简史和技术演变两个维度，全面回顾AI Agent从哲学概念到技术实现的历史进程，展现人机交互的崭新图景。

### 1.2.1 AI Agent的发展简史

谈到AI Agent，很多人都认为它是LLM的产物，因为大部分人接触AI Agent是从基于GPT-4的AutoGPT、BabyGPT、MetaGPT等开源Agent项目开始的。事实上，AI Agent概念并不是当今的产物，而是伴随人工智能而出现的智能实体概念不断进化的结果。最早的AI Agent思想来源于哲学，老子、亚里士多德、庄子等古代思想家都曾提到过类似的概念。

从哲学思想启蒙，到人工智能实体落地，再到现在基于LLM的AI Agent的出现，沿着这一脉络，本书将AI Agent的发展历史分为哲学启蒙、人工智能实体化和基于LLM的AI Agent三个阶段。

#### 1. 起源：哲学启蒙

Agent是一个有着悠久历史的概念，很早之前就已在许多领域得到了探索和解释。关于AI Agent的起源，还要从哲学领域开始探寻。一些论文将其追溯到公元前350年左右的亚里士多德时期，当时的一些哲学家就曾在哲学作品中描述过一些拥有欲望、信念、意图和采取行动能力的实体。

若从古代哲学家的思想著述中寻找Agent的踪迹，还可以把时间继续上溯到公元前485年左右的中国春秋时期，从老子的思想巨著《道德经》中也可以看到Agent的影子。《道德经》第四十二章写道：“道生一，一生二，二生三，三生万物。”用现代计算科学的眼光来看，它所描绘的“道”或许正是一个生生不息、包容万物并且能够自我演化的实体，这种实体小到种子的生发荣枯，大到宇宙天体的周天运转，正是典型的自主Agent。

时间再晚一些的庄子，在“庄周梦蝶”的时候，不知道自己是庄子还是蝴蝶，分不清是梦境还是现实。用现代计算科学的眼光来看，这个梦可以理解为元宇宙，那么梦里的蝴蝶以及所有具有生命的物体，便都如斯坦福大学和谷歌的研究者们构建的虚拟小镇Smallville中的生成式Agent（Generative Agent）一样。

到了18世纪，法国思想启蒙运动时期的丹尼斯·狄德罗（Denis Diderot）也提出了类似的观点：如果鹦鹉可以回答每个问题，它就可以被认为是聪明的。虽然狄德罗在著作中写的是鹦鹉，但谁都能体会到这里的“鹦鹉”并不是指一只鸟，而是突出了一个深刻的概念，即高度智能的有机体，有着类似于人类的智能。

是不是很有意思？我们认为近代人类在科技领域取得一定进展后才设想的AI Agent，其实古人早就思考并探索过。或许正是这些思想才引发了人类对于各种工具的极致追求，诞生了春秋战国时期鲁班打造的能飞三天三夜的“木鹊”与墨家打造的机关城，三国时期的木牛流马和指南车，唐代“酌酒行觞”的木人“女招待”，以及明朝帮人干活的多种“机关转捩”木头人。

这些古代的自动化工具，并非具备分析及推理能力并能够采取行动的Agent，但自古

至今一直存在的这些想法与做法，恰恰反映了人类数千年来对于Agent或者说自动化的持续追求。通过这些思想我们也能获悉，Agent的哲学概念泛指具有自主性的概念或实体，它可以是人造的物体，可以是植物或动物，当然也可以是人。

#### 2. 发展：人工智能实体化

不管最早的Agent描述出自哪里，这些哲学思想都在不同程度上启发了近代Agent。20世纪50年代，图灵把“高度智能有机体”的概念扩展到了人工实体，并提出了著名的图灵测试。这个测试是人工智能的基石，旨在探索机器是否可以显示与人类相当的智能行为。这些人工智能实体通常被称为Agent，形成了人工智能系统的基本构建块。至此，人工智能领域提到的Agent，通常是指能够使用传感器感知其周围环境、做出决策并使用执行器（Actuator）采取相应行动的人工实体。

随着人工智能的发展，术语Agent在人工智能研究中找到了自己的位置，用来描述显示智能行为并具有自主性、反应性、主动性和社交能力等素质的实体。此后，Agent的探索和技术进步成为人工智能领域的焦点。20世纪50年代末到60年代是人工智能的创造时期，所出现的编程语言、书籍及电影到现在还在持续影响更多的人。

在经历第一次人工智能寒冬后，20世纪80年代出现了一股人工智能热潮。这段时间内各项研究都有所突破，来自政府等机构的投资开始增多，研究者对AI Agent的探索也在逐步增加。但这股热潮仅维持了几年，1987年迎来了第二次人工智能寒冬。寒潮延续了很多年，在这期间大部分机构缺少资金支持，尽管如此，人工智能还是沿着既有的技术路线“刚毅”发展。

其中，AI Agent就在1995年被Wooldridge和Jennings定义为一个计算机系统：它位于某个环境中，能够在这个环境中自主行动，以实现其设计目标。他们还提出AI Agent应具有自主性、反应性、社会能力与主动性四个基本属性。而在AI Agent正式被经济学接纳后，它也被进一步定义为具备感知其环境并采取行动以最大限度地提高成功机会的系统。根据这个定义，能够解决特定问题的简单程序也是AI Agent，所以后来能够在各种棋类游戏中与人类对弈的机器人也算是AI Agent的一种。

AI Agent范式将AI研究定义为“智能代理研究”，它研究各种智力，超越了研究人类智能。在AI Agent被赋予“四种基本属性”期间，1993年到2011年，出现了很多基于当时的AI技术且令人印象深刻的Agent类项目。这些项目的出现时间和简介如下：

● 1997年，深蓝（由IBM开发）在一场广为人知的比赛中击败了世界国际象棋冠军加里·卡斯帕罗夫，成为第一个击败人类国际象棋冠军的程序。

● 1997年，Windows发布了语音识别软件（由Dragon Systems开发）。 

● 2000年，Cynthia Breazeal教授开发了第一个可以用面部模拟人类情感的机器人，它拥有眼睛、眉毛、耳朵和嘴巴，被称为Kismet。 

● 2002年，IROBOT公司推出全球第一个具有传感器的扫地机器人Roomba。 

● 2003年，美国宇航局将两辆火星车（“勇气”号和“机遇”号）降落在火星上，它们在没有人类干预的情况下在火星表面航行。 

● 2006年，Twitter、Facebook和Netflix等公司开始将AI算法作为其广告和用户体验（UX）算法的一部分。 

● 2010年，微软推出了Xbox 360 Kinect，这是第一款旨在跟踪身体运动并将其转化为游戏方向的游戏硬件。 

● 2011年，一台名为Watson（由IBM创建）的NLP计算机被编程来回答问题，在电视转播的智力比赛节目Jeopardy!中战胜了两位前冠军。 

● 2011年，苹果发布了Siri，这是第一个流行的虚拟助手。 

#### 3. 当代：基于LLM的AI Agent

在2012年的ImageNet计算机视觉挑战赛中，AlexNet卷积神经网络的深度
