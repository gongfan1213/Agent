### 第1章 全面认识AI Agent
为了实现这一点，它需要对环境进行建模，该环境可以简单也可以复杂。然后，根据概率分布和效用函数评估每个可能结果的预期效用。最后，选择具有最高预期效用的操作，并在每个时间步重复此过程。比如Anthropic的Claude就可以被视作基于实用程序的Agent，其目标是帮助持卡会员最大限度地提高使用卡的奖励和利益。

为了实现目标，它使用效用函数将代表成功或幸福的数值分配给不同的状态（持卡人面临的情况，例如购物、支付账单、兑换奖励等），比较每个状态下不同行动的结果，并根据其效用值做出权衡决策。此外，它还使用启发式和人工智能技术来简化与改进决策。

#### 基于实用程序的Agent的优点如下：
- 处理广泛的决策问题；
- 从经验中学习并调整决策策略；
- 为决策提供一致且客观的框架。

#### 基于实用程序的Agent的缺点如下：
- 需要准确的环境模型，否则会导致决策错误；
- 计算成本高昂并且需要大量计算；
- 不考虑道德或伦理因素；
- 人类难以理解和验证。

### 5. 学习型Agent
学习型Agent具有从过去的经验中学习的能力，能够根据学习情况采取行动或做出决定。它从过去获得基础知识，并利用这些知识来自动行动和适应。它一般由四部分组成，分别是学习元素、评价者、性能元素和问题生成器。学习型Agent的架构如图1-6所示。
- **学习元素**：根据从环境中获得的经验进行学习和改进。
- **评价者**：根据预定义标准的Agent表现向学习元素提供反馈。 
- **性能元素**：根据来自学习元素和评价者的信息选择并执行外部动作。
- **问题生成器**：建议采取行动，为学习元素创造新的、信息丰富的体验，以提高其性能。

学习型Agent遵循观察、学习和基于反馈采取行动的循环步骤，能够与环境互动，并从反馈中学习，通过修改自己的行为来适应未来的互动。循环步骤的工作原理如下：

1. **观察**：Agent通过传感器或其他输入观察环境。

2. **学习**：Agent使用算法和统计模型分析数据，从有关行为和性能的反馈中学习。

3. **行动**：根据所学到的知识，Agent在环境中采取行动来决定如何行事。

4. **反馈**：Agent通过奖励、惩罚或环境线索接收有关行为和表现的反馈。 

5. **适应**：利用反馈，Agent改变行为和决策过程，更新知识并适应环境。

![image](https://github.com/user-attachments/assets/cc97ecb1-abdb-4a08-84b6-9ba92d0a4439)


这个循环随着时间的推移不断重复，使Agent能够不断提高其性能并适应不断变化的环境。AutoGPT就是一个很好的学习型Agent，如果你想买一个智能耳机或者陪护机器人，只需要通过提示让AutoGPT对排名前十的产品进行市场研究，并提供有关其优缺点的见解。AutoGPT会通过探索各种网站和来源来分析排名前十的产品的优缺点。它使用子Agent程序评估网站的真实性。最后，它会生成一份详细的报告，总结调查结果并列出排名前十的产品的优缺点。

#### 学习型Agent的优点如下：
- 可以根据人工智能决策将想法转化为行动；
- 可以遵循基本命令（例如语音指令）来执行任务；
- 与执行预定义操作的经典Agent不同，学习型Agent可以随着时间的推移而发展；
- 考虑效用测量，因而更加现实。

#### 学习型Agent的缺点如下：
- 容易做出有偏见或不正确的决策；
- 开发和维护成本高；
- 需要大量计算资源；
- 依赖大量数据；
- 缺乏类人的直觉和创造力。

### 6. 分层Agent
分层Agent按层次结构构建，较高级别的Agent监督较低级别的Agent。不过，级别可能会因系统的复杂性而有所不同。分层Agent可用于各种应用，例如机器人、制造和运输。它擅长协调多项任务和子任务并确定优先级。分层Agent的工作方式就像组织一样，以由不同级别组成的结构化层次结构来组织任务。其中较高级别的Agent监督目标并将其分解为更小的任务，较低级别的Agent执行这些任务并提供进度报告。

在复杂的系统中，可能存在中间级别的Agent来协调较低级别Agent与较高级别Agent的活动。UniPi是Google推出的一款创新的分层Agent，它利用文本和视频作为通用界面，能够在各种环境中学习各种任务。UniPi包含生成指令和演示的高级策略以及执行任务的低级策略。高级策略适应各种环境和任务，而低级策略通过模仿和强化学习进行学习。这种分层设置使UniPi能够有效地将高级推理和低级执行结合起来。

#### 分层Agent的优点如下：
- 分层Agent通过将任务分配给最合适的Agent并避免重复工作来提高资源利用效率。
- 层次结构通过建立明确的权力和方向来加强沟通。
- 分层强化学习通过降低动作复杂性和增强探索来改进Agent的决策。它采用高级操作来简化问题并促进Agent学习。 
- 分层分解能够通过更简洁和可重用地表示整体问题来最小化计算复杂性。

#### 分层Agent的缺点如下：
- 使用层次结构解决问题时会产生复杂性。
- 固定的层次结构限制了对变化或不确定环境的适应性，阻碍了Agent调整或寻找替代方案的能力。
- 分层Agent遵循自上而下的控制流，即使较低级别的任务已准备就绪也要等待较高级别的任务先执行，这可能导致瓶颈和延迟。
- 层次结构可能缺乏跨不同问题域的可重用性，需要为每个问题域创建新的层次结构，这非常耗时且依赖于专业知识。
- 由于需要标记的训练数据和精心设计的算法，训练分层Agent具有挑战性。由于设计的复杂性，应用标准机器学习技术来提高性能变得很困难。

### 1.3.2 根据Agent的自主性能划分
随着LLM的出现，融合LLM的Agent面向更加多元与复杂的业务应用场景，开始衍生出新的种类。LLM为Agent带来了更强的自主性，因为功能、生成方式、应用场景等方面的不同，出现了自主Agent与生成式Agent。

#### 1. 自主Agent
自主Agent是一种特殊的AI Agent，具有自主决策和行动的能力，可以在没有外部指令或人工干预的情况下进行学习、推理和决策，并执行相应的操作。与传统的AI系统相比，自主Agent具有更高的自主性、适应性和交互性，代表了人工智能从算法驱动到行为驱动的重要演进。自主Agent的基本架构如图1-7所示。 

![image](https://github.com/user-attachments/assets/981d3592-4dc6-46c4-955b-f83d1a2015ec)


自主Agent利用LLM的能力来感知环境并执行任务。当给定目标时，它能够自行创建任务、完成任务、创建新任务、重新确定不同任务的优先级、完成新的最高优先级任务，并循环直到达到目标。如AutoGPT等自主Agent，能够根据人们用自然语言提出的需求自动执行任务并实现预期结果。在这种合作模式下，自主Agent主要是为人类服务，更像是一个高效的人机协同工具。

自主Agent侧重于Agent的自主性和行为能力，强调Agent能够在动态环境中自主地感知、决策和行动，以完成特定任务。其核心是自主决策和控制，它需要集成感知、规划、导航、操控等多种能力，才能适应复杂环境。自主Agent的典型应用如智能机器人、无人驾驶、智能调度等，体现了人工智能在现实世界中的行动能力。

目前大家所说的Agent多数是基于LLM的自主Agent，它已被认为是通向通用人工智能（AGI）最有希望的道路。需要说明的是，本书介绍的AI Agent主要是基于LLM的自主Agent。

#### 2. 生成式Agent
生成式Agent一般基于GPT、文心大模型等LLM构建，以自然语言存储Agent的完整经历记录。生成式Agent的架构包含三个主要组件：记忆流、反思和规划。这些组件协同工作，使生成式Agent能够生成反映其个性、偏好、技能和目标的现实且一致的行为。图1-8为生成式Agent的架构。


![image](https://github.com/user-attachments/assets/acbcc603-11d3-4cae-b737-91ce1e134710)


2023年4月，斯坦福大学和谷歌的研究者共同创建的虚拟小镇Smallville正式开启了生成式Agent之路。小镇里的25个AI Agent，每天都在乐此不疲地散步、约会、聊天、用餐以及分享当天的新闻。生成式Agent就像美剧《西部世界》中的人形机器人以及《失控玩家》中的智能NPC（非玩家角色）一样，在同一环境中生活，拥有自己的记忆和目标，不仅与人类交往，还会与其他机器人互动。

生成式Agent侧重于Agent的生成和创造能力，强调Agent能够根据环境和目标自主地生成、构建和优化各种智能内容或行为策略。其核心是自主学习和优化，它需要运用深度学习、强化学习、进化计算等技术，从数据或环境反馈中学习和改进。生成式Agent的典型应用有智能内容创作、药物设计、自动编程等，体现了人工智能在赋能创新方面的巨大潜力。

自主Agent和生成式Agent代表了人工智能在行动和创造两个维度的延伸与拓展。未来，这两类智能Agent将进一步融合，形成更加全面、灵活的Agent形态，在更广阔的应用领域发挥重要作用。

### 延伸：自动化与拟人化成为AI Agent的两大应用方向
结合目前学术界和产业界基于LLM开发的AI Agent的应用情况，AI Agent可分为两大类：自主Agent和Agent模拟。自主Agent力图实现复杂流程自动化。当给定Agent目标时，它能够自行创建任务、完成任务、创建新任务、重新确定不同任务的优先级、完成新的最高优先级任务，并不断重复这个过程，直到完成目标。它对准确度要求高，因而更需要外部工具辅助来减少LLM不确定性的负面影响。Agent模拟力图更加拟人可信。它分为强调情感、情商的Agent和强调交互的Agent，后者往往是在多Agent环境中，可能涌现出超越设计者规划的场景和能力，LLM生成的不确定性反而成为其优势，多样性使其有望成为AIGC的重要组成部分。

两种智能体的主要区别如图1-9所示。需要说明的是，两大方向并不是割裂的。自动化与拟人化将作为AI Agent的两大核心能力并行发展，随着底层模型的不断成熟以及行业探索的逐渐深入，有望进一步扩大AI Agent的适用范围，提升其实用性。

![image](https://github.com/user-attachments/assets/e3be7943-cffc-41d7-b3f2-2c4a2894f6f5)


### 1.3.3 根据Agent数量与协作能力划分
单Agent已经非常强大了，但为了更好地发挥Agent的特性并解决单Agent存在的一些问题，又出现了能够彼此通信、相互合作并扮演各种角色的多Agent。这样，从Agent系统数量与实际部署及协作应用角度，Agent又可以分为单Agent系统与多Agent系统。复旦大学NLP团队在论文“The Rise and Potential of Large Language Model Based Agents: A Survey”中将AI Agent分为三类，分别是单Agent系统、多Agent系统和人类与Agent的交互。AI Agent分类如图1-10所示。

![image](https://github.com/user-attachments/assets/dcb9b0cb-401f-437a-84dd-6b37f26b3f23)


#### 1. 单Agent系统
单Agent系统是指由单个Agent组成的系统，这个Agent在特定环境中独立运作，执行任务或做出决策。它的行为和决策取决于自身而非其他个体。在这种系统中，Agent通过感知环境进行规划，并根据规划做出行动。AutoGPT等都属于单Agent系统。在具体应用中，单Agent系统可以分为任务导向型部署、创新导向型部署及生命周期导向型部署三种形式。单Agent系统在许多应用中都非常有用，如个人助手、自动化工具、在线客服等。

#### 2. 多Agent系统
多Agent系统是指由多个相互作用的Agent组成的系统，这些Agent在一定程度上是自治的，并且能够与其他Agent通信和协作以解决复杂问题。在具体应用时，多Agent交互一般分为合作性交互与对抗性交互两种情况。多Agent系统在许多领域都可以应用，包括但不限于供应链管理、智能交通系统、机器人群体、经济模型、社交网络分析。

#### 3. 人类与Agent的交互
这一类别分为两种模式：一种是指导者 - 执行者范式，即人类提供指导或反馈，Agent充当执行者；另一种是平等伙伴关系范式，即Agent像人类一样，能够与人类进行移情对话，并参与非合作任务。

其中多Agent交互和人类与Agent的交互都涉及多Agent系统。这是一种由一系列相互作用的Agent及相应的组织规则和信息交互协议构成的系统，内部的各个Agent之间通过相互通信、合作、竞争等方式，完成单个Agent不能完成的大量而又复杂的工作，是“系统的系统”。

多Agent系统是多个Agent的集合，其目标是将大而复杂的系统建设成小的、彼此相互通信和协调的、易于管理的系统。它的研究涉及Agent的知识、目标、技能、规划以及如何使Agent采取协调行动解决问题。BabyAGI、CAMEL、MetaGPT等都是比较知名的多Agent框架。

### 1.3.4 根据业务流程复杂程度划分
AI Agent为处理各种复杂任务而生，就复杂任务的处理流程而言，AI Agent又可以分为两大类，即行动类Agent和规划执行类Agent。

#### 1. 行动类Agent
行动类Agent负责执行简单直接的任务，例如通过调用API来检索最新的天气信息。这类Agent的设计优先考虑直接将输入和输出进行映射，而不是复杂的推理和符号操作。它们通常需要较少的计算资源，从而能做出更快的反应，但可能缺乏复杂的高层决策和规划能力。

#### 2. 规划执行类Agent
规划执行类Agent首先会制定一个包含多个操作的计划任务，然后按照顺序去执行这些操作。这种方案对于复杂任务的执行而言是非常有用的，例如AutoGPT、BabyAGI、GPT Engineer等都是这样的例子。需要注意的是，在Agent执行计划时以下两点特别重要：
- **反思与完善**：Agent中设置了一些反思与完善的Agent机制，可以让其进行自我批评和反思，与其他信息源形成对比，从错误中不断地吸取教训，同时针对未来的步骤进行完善，提升最终的效果和质量。
- **长期记忆**：常见的上下文学习（提示工程）都是利用模型的短期记忆来学习的，但是AI Agent则提供了长期保留和调用无限信息的能力，这通常是利用外部的向量存储和快速检索来实现的。

### 1.3.5 根据功能、任务与应用场景划分
根据功能、任务与应用场景，可以将AI Agent划分为以下几类。
#### （1）对话Agent
- **任务型对话Agent**：完成特定领域的任务，如客服、订票、点餐等。
- **开放域对话Agent**：就开放性话题进行聊天，提供陪伴、娱乐等功能。 
- **知识问答Agent**：根据用户问题进行检索、推理和回答。

#### （2）智能助理Agent
- **个人助理Agent**：协助用户完成日程管理、邮件处理、信息检索等任务。
- **工作助理Agent**：辅助专业人士进行数据分析、报告撰写、决策支持等。
- **教育助理Agent**：为学生提供个性化学习指导、作业辅导等服务。

#### （3）推荐Agent
- **商品推荐Agent**：根据用户偏好、历史行为推荐商品或服务。
- **内容推荐Agent**：根据用户兴趣推荐文章、视频、音乐等内容。
- **社交推荐Agent**：推荐好友、社交活动、兴趣组等。

#### （4）自动化Agent
- **工业自动化Agent**：对生产线、设备等进行监控、调度、优化控制。
- **办公自动化Agent**：完成文档处理、流程审批、信息录入等办公任务。
- **家庭自动化Agent**：控制家电、安防、能源管理等智能家居设备。

#### （5）决策支持Agent
- **金融决策Agent**：进行投资分析、风险评估、交易执行等。
- **医疗决策Agent**：辅助诊断、治疗方案制定、药物推荐等。
- **企业决策Agent**：支持市场分析、战略规划、资源调度等决策。

#### （6）仿真Agent
- **游戏角色Agent**：扮演游戏中的虚拟角色，提供智能对战、互动体验。
- **虚拟人/数字人Agent**：模拟现实人物，进行人机交互、创作表演等。
- **群体仿真Agent**：模拟社会群体行为，进行政策分析、效果预测等。

#### （7）感知与交互Agent
- **计算机视觉Agent**：对图像和视频进行分析、识别、理解等。
- **语音交互Agent**：进行语音识别、语音合成、声纹认证等。
- **体感交互Agent**：捕捉和理解人体姿态、手势、表情等信号。

#### （8）执行Agent
- **机器人控制Agent**：对物理机器人进行感知、规划、控制。
- **无人系统Agent**：对无人车、无人机等进行自主导航、任务执行。
- **智能硬件Agent**：对可穿戴设备、智能家电等进行控制和优化。

#### （9）安全Agent
- **网络安全Agent**：进行异常检测、威胁分析、攻击溯源等，维护网络安全。
- **身份认证Agent**：通过生物特征、行为模式等进行用户身份验证。
- **隐私保护Agent**：对敏感数据进行脱敏、加密，防止隐私泄露。

#### （10）协作Agent
- **物流调度Agent**：协同优化仓储、配送、运输等物流环节。
- **供应链协同Agent**：促进供应商、生产商、零售商等协同运作。 
- **跨组织协同Agent**：支持不同企业、机构之间的业务协同与资源共享。

以上分类并不是绝对和完全穷举的，一些Agent可能兼具多种功能，或者按照不同维度有不同归属。未来随着技术进步和应用创新，还会出现新的Agent类型。AI Agent正在向多功能、跨场景、协同化的方向演进，为人类在各个领域提供更加智能、高效、个性化的服务与支持。 
