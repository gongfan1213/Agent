# Lesson 4 What is the Agent Tool Use Design Pattern?
lesson what is the tool use design pattern how does it help AI agents do more and what should we plan for when using it to build AI agents we're going to answer these questions in the fourth lesson of the AI agents for beginners course in this course we take you from concept to code covering the fundamentals of building AI agents and in this short video follows along with the written lesson including translations and a code samples that you can find at the link above and below the video so let's get started looking at what the tool use design pattern is and while while LLMs are very effective on their own in generating content tasks that are requested by users sometimes require external tools to complete and the tool design pattern allows the LMS to interact with these tools such as a calculators APIs to tell us about flight status or a function within our application handling currency exchange to understand the benefits of this let's take a look at a few use cases for example an AI agent can create database queries using tools for generating code and a be able to retrieve real-time information from a customer database of the customer's travel loyalty points and travel preferences or an AI agent can be connected to a CRM system and to answer specific questions about a customer's travel booking rather than needing a human intervention to do so and while we've been talking about single-use tools agents can also combine tools in order to automate workflows for example analyzing an email retrieving the relevant B knowledgebased information and then forwarding it that email to customer service representative to make that process more efficient there's a lot to consider when talking about tool calling for example security making sure AI agents have only the type of access required and handling errors because sadly we don't live in a perfect world where the services that the agent might be using are always running maybe one day but we will cover these topics more in depth in our trustworthy AI agents lesson and AI agents in production but let's head over to our code and build a tool calling AI agent okay so now we're at our code editor and we're using the semantic kernel tool example with the notebook again you can find this code at the link above and below this video and we've been covering tool calling in the other lessons as well but I want to show you just a few other kind of options and abilities that we have within this kind of world of tool calling and in this case we have this destinations plugin uh we're g using semantic kernel and we have one that just has a list of destinations that are available basically a list of destinations and then the other one is the actual availability so you can kind of think of this maybe as two different databases or maybe one that has uh you know a list of things that are destinations available and then the current status uh whether they're you know being able to be booked or not so we will also show this in in terms of the function behavior so this is another kind of setting built built into semantic kernel where we can have this either be auto so it basically allows the agent to choose when to call the function or when not to uh whenever whenever it deems it appropriate or we're required when we want to make sure that the agent is calling a function depending on the kind of use case and scenario that we have again we're setting up the agent like before but in this case we want to have three user inputs and I want to show kind of the value of working with tool calling here first the one is the user input the question is you know what destinations are available then it's going to ask about a specific destination and then it's going to ask are there any destinations available not in Europe uh and we can look at the interaction here to see how this goes so first is what destinations are available and as expected this is going to call the get destinations plug-in or function and this result is going to give back our list and then it can go ahead and show that list to the user um and this again is just saying this is just getting the destinations right not just specifically about the availability of them but what ones can I actually book and then it's going to actually the user is going to ask about is Barcelona available so again kind of similarly query but in this case instead of calling the get destinations since it give us a specific destination we can call the get availability and see that the result is that Barcelona is unavailable and the travel agent responds accordingly saying Barcelona is currently unavailable but I want to show this as another kind of example of why uh you know we're not just making API API recalls here but also using the power of large language models to interpret natural language because in this case you know there are there any vacation destinations available not in Europe uh we don't have to as developers are building these agents define which ones are in Europe or not because the large language model has all of that within it sort of base training data so in this case you don't need to have a new function saying is in Europe or not in Europe or anything like that right we can just first that large model is going to call the get availability in this case it already has deemed that Tokyo Japan is not in Europe and that New York uh is not also in Europe but it's going to call that specific uh function the get availability to see which ones are not available and then we get the result for both of them and then perfectly it says that New York is available and also gives an kind of extra information that Tokyo Japan is currently unavailable so again this really shows you the power of using agents large language models to both use their abilities to interpret natural language to have that sort of interaction as well as tool calling to give it the specific data based on that interpretation and that plan from the agent itself so that was tool calling we're going to continue to use this as a feature in other samples but we'll see you in the next lesson
### 翻译
#### 第4课：什么是代理工具使用设计模式？
什么是工具使用设计模式？它如何帮助人工智能代理实现更多功能？当我们使用它来构建人工智能代理时应该做哪些规划呢？我们将在人工智能代理初学者课程的第四课中回答这些问题。在这门课程中，我们会带你从概念到代码，涵盖构建人工智能代理的基础知识。这个短视频是配合书面课程的，包括翻译以及你可以在本视频上方和下方的链接中找到的代码示例。那么，让我们开始了解什么是工具使用设计模式。虽然大型语言模型（LLMs）自身在生成用户请求的内容方面非常有效，但有时用户请求的任务需要外部工具来完成。工具设计模式允许大型语言模型与这些工具进行交互，比如计算器、用于告知我们航班状态的应用程序编程接口（APIs），或者我们应用程序中处理货币兑换的函数。为了理解这种模式的好处，让我们来看几个用例。例如，一个人工智能代理可以使用生成代码的工具创建数据库查询，并且能够从客户的旅行忠诚度积分和旅行偏好的客户数据库中检索实时信息；或者一个人工智能代理可以连接到客户关系管理（CRM）系统，以回答关于客户旅行预订的特定问题，而无需人工干预来完成。虽然我们一直在讨论单一用途的工具，但代理也可以组合工具来实现工作流程的自动化。例如，分析一封电子邮件，检索相关的知识库信息，然后将该电子邮件转发给客户服务代表，以使这个过程更高效。当谈到工具调用时，有很多需要考虑的因素，例如安全性，要确保人工智能代理仅拥有所需类型的访问权限；还有错误处理，因为遗憾的是，我们生活的世界并不完美，代理可能使用的服务并不总是能正常运行（也许有一天会吧）。但我们将在 “可信赖的人工智能代理” 课程以及 “生产环境中的人工智能代理” 课程中更深入地讨论这些主题。不过，让我们进入代码部分，构建一个调用工具的人工智能代理吧。

好的，现在我们在代码编辑器中，我们再次使用语义内核工具的笔记本示例。你可以在本视频上方和下方的链接中找到这段代码，我们在其他课程中也讨论过工具调用，但我想向你展示在工具调用这个领域中我们还有的一些其他选项和能力。在这个例子中，我们有这个 “目的地插件”，我们使用的是语义内核，其中一个插件只是有一个可用目的地的列表，基本上就是一个目的地列表；另一个插件是实际的可用性信息。所以你可以把这想象成两个不同的数据库，或者一个数据库中包含可用目的地的列表以及当前的状态信息（即这些目的地是否可以被预订）。我们还将从函数行为的角度来展示这一点。这是语义内核中内置的另一种设置，我们可以将其设置为自动模式，这基本上允许代理在它认为合适的时候选择调用函数或不调用函数；或者根据我们的用例和场景，当我们希望确保代理调用某个函数时，也可以进行相应设置。我们像之前一样设置代理，但在这种情况下，我们想要有三个用户输入，并且我想在这里展示一下使用工具调用的价值。第一个用户输入的问题是 “有哪些可用的目的地？”，然后会询问一个特定的目的地，接着会询问 “有没有不在欧洲的可用目的地？”。我们可以看看这里的交互过程，看看是如何进行的。首先是 “有哪些可用的目的地？”，正如预期的那样，这将调用 “获取目的地” 插件或函数，结果将返回我们的目的地列表，然后它可以继续将该列表展示给用户。这只是在获取目的地，而不是具体关于它们的可用性，只是哪些是我实际上可以预订的。然后用户会询问 “巴塞罗那可用吗？”，这又是一个类似的查询，但在这种情况下，由于用户给出了一个特定的目的地，所以不是调用 “获取目的地” 函数，而是调用 “获取可用性” 函数，结果显示巴塞罗那不可用，旅行代理也相应地回复说 “巴塞罗那目前不可用”。但我想把这作为另一个例子来展示为什么我们不只是在这里进行应用程序编程接口调用，还要利用大型语言模型来解释自然语言的能力。因为在这种情况下，“有没有不在欧洲的可用度假目的地？”，作为开发人员，我们在构建这些代理时不必定义哪些目的地在欧洲或不在欧洲，因为大型语言模型在其基础训练数据中已经包含了所有这些信息。所以在这种情况下，我们不需要有一个新的函数来判断 “在欧洲” 或 “不在欧洲” 之类的情况。我们可以让大型模型调用 “获取可用性” 函数，在这种情况下，它已经判断出日本东京不在欧洲，纽约也不在欧洲，但它会调用那个特定的 “获取可用性” 函数来查看哪些是不可用的，然后我们得到这两个目的地的结果，并且完美地显示纽约是可用的，还给出了额外的信息，即日本东京目前不可用。所以这再次向你展示了使用代理和大型语言模型的强大之处，既利用它们解释自然语言的能力来进行那种交互，又通过工具调用根据代理自身的解释和计划提供特定的数据。这就是工具调用，我们将在其他示例中继续使用这个功能。下节课见。

### 要点总结
1. **课程概述**：这是人工智能代理初学者课程的第四课，介绍构建人工智能代理的基础知识，视频有配套书面课程、翻译和代码示例。
2. **工具使用设计模式的定义与作用**：
    - 大型语言模型有时需借助外部工具完成用户任务，工具使用设计模式允许LLMs与如计算器、APIs等工具交互。
    - 用例包括代理创建数据库查询获取客户信息、连接CRM系统回答客户预订问题、组合工具自动化工作流程（如分析邮件并转发）。
3. **工具调用的考虑因素**：
    - 安全性：确保代理仅获所需访问权限。
    - 错误处理：因服务可能无法正常运行，需处理相关错误，后续课程会深入讨论。
4. **代码示例**：
    - 使用语义内核工具示例，有 “目的地插件”，含可用目的地列表和实际可用性信息两个部分。
    - 语义内核可设置工具调用为自动模式，让代理自行决定调用时机。
    - 三个用户输入示例：询问可用目的地，调用 “获取目的地” 函数返回列表；询问特定目的地（巴塞罗那）可用性，调用 “获取可用性” 函数得知不可用；询问不在欧洲的可用目的地，大型语言模型利用训练数据判断并调用 “获取可用性” 函数，得到纽约可用、东京不可用的结果，体现了代理结合语言理解和工具调用的能力。 
